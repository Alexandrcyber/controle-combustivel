<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teste - PDF Completo</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.2/font/bootstrap-icons.css" rel="stylesheet">
    <script src="https://unpkg.com/jspdf@latest/dist/jspdf.umd.min.js"></script>
    <script src="https://unpkg.com/jspdf-autotable@3.5.25/dist/jspdf.plugin.autotable.min.js"></script>
</head>
<body>
    <div class="container mt-4">
        <div class="row">
            <div class="col-12">
                <div class="card border-danger">
                    <div class="card-header bg-danger text-white">
                        <h4 class="mb-0">
                            <i class="bi bi-file-earmark-pdf"></i> 
                            Teste - PDF Completo de Combust√≠vel
                        </h4>
                    </div>
                    <div class="card-body">
                        <div class="alert alert-info">
                            <h5><i class="bi bi-info-circle"></i> Nova Funcionalidade!</h5>
                            <p class="mb-0">
                                <strong>PDF Completo</strong> substitui as duas op√ß√µes de Excel anteriores, 
                                gerando um relat√≥rio abrangente em PDF com todas as an√°lises, dashboards 
                                e dados detalhados em um √∫nico arquivo profissional.
                            </p>
                        </div>
                        
                        <div class="row">
                            <div class="col-md-8">
                                <h6>üìã O que est√° inclu√≠do no PDF:</h6>
                                <div class="row">
                                    <div class="col-md-6">
                                        <ul class="list-group list-group-flush">
                                            <li class="list-group-item">üìä Capa e Resumo Executivo</li>
                                            <li class="list-group-item">üéØ Dashboard Executivo</li>
                                            <li class="list-group-item">üìà An√°lise Detalhada</li>
                                            <li class="list-group-item">üí∞ An√°lise de Custos</li>
                                            <li class="list-group-item">‚ö° Indicadores KPIs</li>
                                        </ul>
                                    </div>
                                    <div class="col-md-6">
                                        <ul class="list-group list-group-flush">
                                            <li class="list-group-item">üîÆ An√°lise Preditiva</li>
                                            <li class="list-group-item">üìã Dados Detalhados</li>
                                            <li class="list-group-item">üé≤ Simulador de Cen√°rios</li>
                                            <li class="list-group-item">üîß Manuten√ß√£o Preventiva</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="text-center">
                                    <button type="button" class="btn btn-danger btn-lg" id="exportarPdfCompleto">
                                        <i class="bi bi-file-earmark-pdf"></i><br>
                                        <strong>Gerar PDF Completo</strong><br>
                                        <small>9 p√°ginas de an√°lise</small>
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <hr>
                        
                        <div class="row mt-4">
                            <div class="col-md-6">
                                <h6>üìä Status dos Dados:</h6>
                                <div id="statusDados" class="alert alert-success">
                                    Carregando dados de teste...
                                </div>
                            </div>
                            <div class="col-md-6">
                                <h6>üìù Log de Execu√ß√£o:</h6>
                                <div id="logTestes" class="alert alert-light" style="max-height: 200px; overflow-y: auto;">
                                    <small>Aguardando teste...</small>
                                </div>
                            </div>
                        </div>
                        
                        <div class="alert alert-warning mt-3">
                            <h6><i class="bi bi-exclamation-triangle"></i> Diferen√ßas da Implementa√ß√£o Anterior:</h6>
                            <ul class="mb-0">
                                <li>‚úÖ <strong>Unificado:</strong> Um √∫nico arquivo PDF ao inv√©s de dois Excel</li>
                                <li>‚úÖ <strong>Profissional:</strong> Layout otimizado para impress√£o e apresenta√ß√£o</li>
                                <li>‚úÖ <strong>Completo:</strong> Todas as an√°lises em formato visual e textual</li>
                                <li>‚úÖ <strong>Port√°til:</strong> PDF funciona em qualquer dispositivo sem depend√™ncias</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts de Mock dos Alertas -->
    <script>
        // Mock para AlertUtils (caso n√£o esteja dispon√≠vel)
        window.AlertUtils = {
            close: () => console.log('Alert fechado')
        };
        
        window.AlertInfo = {
            loading: (titulo, msg) => {
                console.log(`Loading: ${titulo} - ${msg}`);
                adicionarLog(`‚è≥ ${titulo}: ${msg}`, 'info');
            }
        };
        
        window.AlertWarning = {
            show: (titulo, msg) => {
                console.log(`Warning: ${titulo} - ${msg}`);
                adicionarLog(`‚ö†Ô∏è ${titulo}: ${msg}`, 'warning');
            }
        };
        
        window.AlertToast = {
            success: (msg) => {
                console.log(`Success: ${msg}`);
                adicionarLog(`‚úÖ ${msg}`, 'success');
            }
        };
        
        window.AlertError = {
            show: (titulo, msg) => {
                console.log(`Error: ${titulo} - ${msg}`);
                adicionarLog(`‚ùå ${titulo}: ${msg}`, 'error');
            }
        };

        // Simular dados globais para teste
        window.caminhoes = [
            {
                "placa": "TST-8888",
                "modelo": "Scania R450",
                "ano": 2024,
                "id": "1749118873977lmrpqoo1b"
            },
            {
                "placa": "TST-9999", 
                "modelo": "Volvo FH540",
                "ano": 2023,
                "id": "1749118873977lmrpqoo2c"
            }
        ];

        window.abastecimentos = [
            {
                "id": "test1",
                "caminhaoId": "1749118873977lmrpqoo1b",
                "data": "2025-06-01",
                "litros": 50,
                "valorTotal": 300.00,
                "valorLitro": 6.00,
                "odometro": 1000,
                "posto": "Posto Teste 1"
            },
            {
                "id": "test2",
                "caminhaoId": "1749118873977lmrpqoo1b",
                "data": "2025-06-03",
                "litros": 45,
                "valorTotal": 270.00,
                "valorLitro": 6.00,
                "odometro": 1200,
                "posto": "Posto Teste 2"
            },
            {
                "id": "test3",
                "caminhaoId": "1749118873977lmrpqoo2c",
                "data": "2025-06-05",
                "litros": 60,
                "valorTotal": 360.00,
                "valorLitro": 6.00,
                "odometro": 1500,
                "posto": "Posto Teste 3"
            },
            {
                "id": "test4",
                "caminhaoId": "1749118873977lmrpqoo2c",
                "data": "2025-06-07",
                "litros": 55,
                "valorTotal": 330.00,
                "valorLitro": 6.00,
                "odometro": 1800,
                "posto": "Posto Teste 4"
            }
        ];

        // Fun√ß√£o para log
        function adicionarLog(mensagem, tipo = 'info') {
            const logDiv = document.getElementById('logTestes');
            const hora = new Date().toLocaleTimeString();
            const classe = tipo === 'success' ? 'text-success' : 
                          tipo === 'error' ? 'text-danger' : 
                          tipo === 'warning' ? 'text-warning' : 'text-info';
            logDiv.innerHTML += `<div class="${classe}"><strong>[${hora}]</strong> ${mensagem}</div>`;
            logDiv.scrollTop = logDiv.scrollHeight;
        }

        // Mostrar status dos dados
        document.addEventListener('DOMContentLoaded', () => {
            const statusDiv = document.getElementById('statusDados');
            const totalCaminhoes = window.caminhoes.length;
            const totalAbastecimentos = window.abastecimentos.length;
            
            statusDiv.innerHTML = `
                <strong>‚úÖ Dados de teste carregados:</strong><br>
                ‚Ä¢ ${totalCaminhoes} caminh√µes cadastrados<br>
                ‚Ä¢ ${totalAbastecimentos} abastecimentos registrados<br>
                ‚Ä¢ Per√≠odo: 01/06/2025 a 07/06/2025<br>
                ‚Ä¢ Total gasto: R$ 1.260,00<br>
                ‚Ä¢ Combust√≠vel total: 210 litros
            `;
            
            adicionarLog('Sistema de teste inicializado', 'success');
            adicionarLog(`${totalCaminhoes} caminh√µes e ${totalAbastecimentos} abastecimentos carregados`);
        });
    </script>
    
    <!-- Carregar fun√ß√µes de relat√≥rio -->
    <script src="src/js/relatorios.js"></script>
    
    <script>
        // Configurar event listener
        document.addEventListener('DOMContentLoaded', () => {
            // Bot√£o PDF Completo
            document.getElementById('exportarPdfCompleto').addEventListener('click', () => {
                try {
                    adicionarLog('üöÄ Iniciando gera√ß√£o do PDF completo...', 'info');
                    exportarPdfCompleto();
                } catch (error) {
                    console.error('Erro na exporta√ß√£o PDF completo:', error);
                    adicionarLog(`‚ùå Erro na exporta√ß√£o PDF: ${error.message}`, 'error');
                }
            });
            
            adicionarLog('Event listener configurado para PDF completo', 'success');
        });
    </script>
</body>
</html>
